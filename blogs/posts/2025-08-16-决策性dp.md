# 四边形不等式
1. 定义1：在定义域上 $\forall a \le b \le c \le d \in Z$，有 $w_{a, d} + w_{b, c} \le w_{a, c} + w_{b, d}$，则称二元函数 $w$ 满足四边形不等式的。
2. 定义2：在定义域上 $\forall a < b \in Z$ 都有 $a < a + 1 \le b < b + 1$，有 $w_{a, b + 1} + w_{a + 1, b} \le w_{a, b} + w_{a + 1, b + 1}$，则称二元函数 $w$ 满足四边形不等式。

定义1 和定义2 是等价的。

证明方法（定义2 推定义1）：先将 $a$ 每次变成 $a + 1$，然后推导出三元成立，再将 $c$ 每次变成 $c + 1$，最后推出四元成立。

- 定义1 通常是推单调性，定义2 通常来证明这个函数具有四边形不等式性质。
# 优化 dp
当 dp 的转移式满足：$\displaystyle f_i = \min_{0 \leq j < i} \{ f_j + v_{j,i} \}$，且 $v_{j, i}$ 满足四边形不等式，则 $f_i$ 的最优决策具有单调性。

$P_i$ 表示 $f_i$ 取到的最优解的 $j$，则 $P_i$ 单调不降。

- 若 $p$ 对于 $i$ 比 $p$ 前面的所有决策都更优，则 $p$ 对于 $\forall i' > i$ 都有 $p$ 比前面的所有决策更优。

证明：

$$0 \leq j < p < i < i'$$
$$f_p + v_{p, i} \leq f_j + v_{j, i}$$
$$v_{j, i'} + v_{p, i} \ge v_{j, v} + v_{p, i'}$$
$$v_{p, i'} - v_{p, i} \leq v_{j, i'} - v_{j, i}$$
$$f_p + v_{p, i'} \ge f_j + v_{j, i'}$$
