<!DOCTYPE html>
<html lang="zh" id="html-root">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Merge-all 的算法博客，分享构造题、DP 优化、图论与思维题解法" />
  <title>Merge-all's Blog</title>

  <!-- 字体 -->
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:wght@300;400;600&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" rel="stylesheet">

  <!-- 数学公式 & Markdown & 高亮 -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['\\(', '\\)'], ['$','$']],
        displayMath: [['\\[', '\\]'], ['$$','$$']],
        processEscapes: true,
        processEnvironments: true,
        packages: ['base', 'ams']
      },
      chtml: {
        scale: 1.08,
        matchFontHeight: false,
        displayAlign: 'center'
      },
      startup: {
        pageReady: () => {
          document.getElementById('reader-content')?.classList.add('fade-in');
        }
      }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" async></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css" id="hljs-theme-link">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

  <style>
    :root {
      --text: #2c3e50;
      --text-light: #555;
      --bg: #fdfdfd;
      --card: #ffffff;
      --border: #e0e0e0;
      --primary: #d63384;
      --shadow: 0 12px 30px rgba(0, 0, 0, 0.1);
      --shadow-hover: 0 20px 50px rgba(0, 0, 0, 0.18);
      --radius: 16px;
      --transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
      --accent: linear-gradient(135deg, #6f42c1, #d63384);
    }

    [data-theme="dark"] {
      --text: #e0e0e0;
      --text-light: #aaa;
      --bg: #121212;
      --card: #1e1e1e;
      --border: #444;
      --primary: #e95ab6;
    }

    body {
      font-family: 'Source Sans Pro', sans-serif;
      color: var(--text);
      background: var(--bg);
      line-height: 1.8;
      transition: background 0.4s ease, color 0.4s ease;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }

    /* ============= 顶部进度条 ============= */
    #reading-progress {
      position: fixed;
      top: 0; left: 0;
      height: 4px;
      width: 0%;
      background: var(--accent);
      z-index: 10000;
      transition: width 0.1s ease;
      box-shadow: 0 0 10px rgba(111, 66, 193, 0.5);
    }

    /* ============= 顶部导航 ============= */
    .header {
      position: fixed;
      top: 0; left: 0; right: 0;
      z-index: 1000;
      backdrop-filter: blur(12px);
      background: color-mix(in srgb, var(--card) 92%, transparent);
      border-bottom: 1px solid var(--border);
      padding: 18px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: var(--transition);
    }

    .header.scrolled {
      padding: 14px 40px;
      background: color-mix(in srgb, var(--card) 85%, transparent);
      box-shadow: 0 6px 24px rgba(0, 0, 0, 0.12);
    }

    .logo {
      font-family: 'Great Vibes', cursive;
      font-size: 2.6em;
      color: var(--primary);
      text-decoration: none;
      letter-spacing: -1px;
    }

    .logo::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 0;
      height: 2px;
      background: var(--primary);
      transition: width 0.5s ease;
    }

    .logo:hover::after {
      width: 100%;
    }

    .nav-links {
      display: flex;
      gap: 32px;
      align-items: center;
    }

    .nav-links a {
      color: var(--text-light);
      text-decoration: none;
      font-weight: 600;
      font-size: 1em;
      padding: 6px 0;
      border-bottom: 2px solid transparent;
      transition: var(--transition);
    }

    .nav-links a:hover,
    .nav-links a.active {
      color: var(--primary);
      border-color: var(--primary);
    }

    .theme-toggle {
      background: var(--primary);
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9em;
      transition: transform 0.2s ease;
    }

    .theme-toggle:hover {
      transform: rotate(15deg);
    }

    /* ============= 主内容 ============= */
    .container {
      max-width: 860px;
      margin: 150px auto 90px;
      padding: 0 40px;
      opacity: 0;
      animation: fadeInUp 0.9s ease forwards;
    }

    @keyframes fadeInUp {
      0% { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .title h1 {
      font-family: 'Playfair Display', serif;
      font-size: 3.8em;
      font-weight: 700;
      text-align: center;
      background: var(--accent);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .title p {
      text-align: center;
      color: var(--text-light);
      font-size: 1.25em;
      max-width: 680px;
      margin: 0 auto;
      opacity: 0.9;
    }

    /* ============= 文章卡片 ============= */
    .posts {
      display: grid;
      gap: 36px;
      margin-top: 40px;
    }

    .post {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
      overflow: hidden;
      transition: var(--transition);
      opacity: 0;
      transform: translateY(24px);
      will-change: transform;
    }

    .post.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .post:hover {
      transform: translateY(-8px) scale(1.01);
      box-shadow: var(--shadow-hover);
    }

    .post-header {
      padding: 36px 36px 24px;
      border-bottom: 1px solid var(--border);
    }

    .post-title {
      font-size: 2.0em;
      font-weight: 700;
      color: var(--text);
      cursor: pointer;
      display: block;
      margin: 0 0 14px;
      line-height: 1.3;
      transition: var(--transition);
    }

    .post-title:hover {
      color: var(--primary);
      transform: translateX(6px);
    }

    .post-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 18px;
      color: var(--text-light);
      font-size: 0.95em;
    }

    .post-meta-item {
      display: flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
    }

    .post-excerpt {
      padding: 28px 36px 36px;
      color: var(--text-light);
      font-size: 1.12em;
      line-height: 1.75;
      border-top: 1px dashed var(--border);
      background: color-mix(in srgb, var(--bg) 98%, var(--border));
    }

    /* ============= 阅读器 ============= */
    #reader {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: var(--bg);
      overflow-y: auto;
      padding: 100px 40px 80px;
      box-sizing: border-box;
      z-index: 1000;
    }

    #reader button {
      padding: 14px 36px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      font-family: inherit;
      font-size: 1.1em;
      margin-bottom: 20px;
      box-shadow: 0 10px 30px rgba(214, 51, 132, 0.3);
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      gap: 10px;
    }

    #reader button:hover {
      transform: translateY(-3px);
      box-shadow: 0 15px 40px rgba(214, 51, 132, 0.4);
    }

    #back-to-top {
      display: inline-flex;
      margin-left: 12px;
      background: #6c757d;
    }

    #back-to-top:hover {
      background: #5a6268;
    }

    #toc {
      margin: 20px 0 30px;
      padding: 16px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      font-size: 0.95em;
      color: var(--text-light);
    }

    #toc h3 {
      margin: 0 0 12px;
      color: var(--text);
    }

    #toc ul {
      margin: 0;
      padding-left: 1.2em;
    }

    #toc a {
      color: var(--text-light);
      text-decoration: none;
    }

    #toc a:hover {
      color: var(--primary);
      text-decoration: underline;
    }

    #reader-content {
      max-width: 900px;
      margin: 0 auto;
      opacity: 0;
      transition: opacity 0.5s ease;
    }

    #reader-content.fade-in {
      opacity: 1;
    }

    /* ============= 骨架屏 ============= */
    .skeleton {
      background: linear-gradient(90deg, #f0f0f0, #e0e0e0, #f0f0f0);
      background-size: 300% 100%;
      animation: loading 1.5s infinite;
      border-radius: 6px;
    }

    @keyframes loading {
      0% { background-position: -300% 0; }
      100% { background-position: 300% 0; }
    }

    .skeleton-title { height: 32px; width: 80%; margin: 0 auto 20px; }
    .skeleton-para { height: 18px; width: 100%; margin-bottom: 12px; }

    /* ============= 列表样式（完全手动控制） ============= */
    ol.clean, ul.clean {
      margin: 1.4em 0;
      padding-left: 1.8em;
    }

    ol.clean > li {
      list-style: none;
      position: relative;
      padding-left: 0.2em;
    }

    ol.clean > li::before {
      content: counter(item) ".";
      counter-increment: item;
      position: absolute;
      left: -1.6em;
      width: 1.4em;
      color: var(--text);
    }

    ul.clean > li {
      list-style: none;
      position: relative;
      padding-left: 0.2em;
    }

    ul.clean > li::before {
      content: "•";
      position: absolute;
      left: -1em;
      color: var(--text);
    }

    /* ============= 代码块 ============= */
    code {
      font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
      background: rgba(0, 0, 0, 0.06);
      color: var(--text);
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.95em;
    }

    pre {
      margin: 2.2em 0;
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid var(--border);
      background: var(--card);
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
      position: relative;
    }

    pre code {
      display: block;
      padding: 18px;
      margin: 0;
      background: none;
      color: var(--text);
      font-size: 0.95em;
      tab-size: 4;
      line-height: 1.6;
      overflow-x: auto;
    }

    .lang-tag {
      position: absolute;
      top: 12px;
      left: 12px;
      background: var(--primary);
      color: white;
      font-size: 0.75em;
      padding: 4px 8px;
      border-radius: 6px;
      font-weight: bold;
    }

    /* ============= 图片 ============= */
    #reader-content img {
      display: block;
      margin: 2em auto;
      max-width: 100%;
      border-radius: 12px;
      border: 1px solid var(--border);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
    }

    /* ============= 响应式 ============= */
    @media (max-width: 768px) {
      .header { padding: 16px 20px; }
      .logo { font-size: 2.2em; }
      .nav-links { gap: 20px; }
      .container { margin-top: 120px; padding: 0 20px; }
      .title h1 { font-size: 2.8em; }
      .post-title { font-size: 1.7em; }
      .post-header, .post-excerpt { padding: 28px; }
      .post-meta { gap: 14px; }
      #reader { padding: 100px 20px 60px; }
    }
  </style>
</head>
<body>

  <div id="reading-progress"></div>

  <header class="header">
    <a href="/" class="logo">Merge-all</a>
    <nav class="nav-links">
      <a href="/">Home</a>
      <a href="#" class="active">Blog</a>
      <button class="theme-toggle" onclick="toggleTheme()">
        <i class="fas fa-moon"></i>
      </button>
    </nav>
  </header>

  <div class="container">
    <div class="title">
      <h1>My Blog</h1>
      <p>记录算法学习的点点滴滴，分享思考与感悟</p>
    </div>

    <div class="posts">
      <article class="post">
        <div class="post-header">
          <h2 class="post-title" onclick="loadPost('construct')">构造专练</h2>
          <div class="post-meta">
            <div class="post-meta-item"><i class="far fa-calendar"></i><span>2025-08-11</span></div>
            <div class="post-meta-item"><i class="far fa-clock"></i><span>5 min read</span></div>
            <div class="post-meta-item"><i class="fas fa-code"></i><span>构造 / 图论 / 贪心</span></div>
          </div>
        </div>
        <div class="post-excerpt">构造太菜了，多多练习涨涨脑子。</div>
      </article>

      <article class="post">
        <div class="post-header">
          <h2 class="post-title" onclick="loadPost('quad')">决策性 DP</h2>
          <div class="post-meta">
            <div class="post-meta-item"><i class="far fa-calendar"></i><span>2025-08-16</span></div>
            <div class="post-meta-item"><i class="far fa-clock"></i><span>5 min read</span></div>
            <div class="post-meta-item"><i class="fas fa-chart-line"></i><span>DP / 四边形不等式</span></div>
          </div>
        </div>
        <div class="post-excerpt">四边形不等式与决策单调性优化。</div>
      </article>
    </div>
  </div>

  <div id="reader">
    <button onclick="closeReader()"><i class="fas fa-arrow-left"></i> Back</button>
    <button id="back-to-top" onclick="window.scrollTo({top:0,behavior:'smooth'})"><i class="fas fa-arrow-up"></i> Top</button>
    <div id="toc"></div>
    <div id="reader-content"></div>
  </div>

  <script>
    // 手动内联文章内容（避免外部加载 + 可完全控制格式）
    const posts = {
      construct: `
        <h1>构造专练</h1>
        <p>构造太菜了，多多练习涨涨脑子。</p>

        <h2><a href="https://www.luogu.com.cn/problem/P3557" target="_blank">[POI 2013] GRA-Tower Defense Game</a></h2>
        <p>一道水绿，一看是还以为攻击距离为 2 是指只能打到相距为 2 的点，画了一下样例以后发现不就是在一开始的基础上多走一步吗。</p>

        <ul class="clean">
          <li>发现：或许在攻击距离为 1 的时候要好好考虑一下分配，可是当你发现攻击距离为 2 的话，随便怎么搞都一定不劣</li>
          <li>我们发现可以考虑去枚举当前加入的点 i 所在段的位置 j-1, j，然后通过前面发现的规律计算出最小值即可。</li>
        </ul>

        <pre><code class="language-cpp">#include <bits/stdc++.h>
using namespace std;
const int N = 5e5 + 10;
int n, m, k, cnt;
vector<int> G[N], ans;
bool vis[N];
void cover(int x) {
	for(int y : G[x]) {
		vis[y] = 1;
		for(int z : G[y])
			vis[z] = 1;
	}
}
int main() {
	ios_base::sync_with_stdio(false);
	cin.tie(nullptr);
	cin >> n >> m >> k;
	for(int i = 1, u, v; i <= m; i ++) {
		cin >> u >> v;
		G[u].emplace_back(v), G[v].emplace_back(u);
	}
	for(int i = 1; i <= n; i ++) {
		if(!vis[i]) {
			vis[i] = true;
			cover(i);
			ans.emplace_back(i);
		}
	}
	cout << ans.size() << '\n';
	for(int it : ans) cout << it << ' ';
	return cout << '\n', 0;
}
</code></pre>

        <h2><a href="https://www.luogu.com.cn/problem/P1268" target="_blank">树的重量</a></h2>
        <p>神仙题，这道题让我知道了<strong>画图找规律</strong>的重要性。</p>

        <ol class="clean">
          <li>n = 2 的情况：显然 $G_{1, 2}$。</li>
          <li>n = 3 的情况：答案是蓝色段长度，$l = \\frac{G_{1,3} + G_{2,3} - G_{1,2}}{2}$</li>
          <li>n = 4 的情况：枚举点所在段，取最小值。</li>
        </ol>

        <pre><code class="language-cpp">#include <bits/stdc++.h>
using namespace std;
const int N = 110;
int n, G[N][N], ans;
int main() {
	ios_base::sync_with_stdio(false);
	cin.tie(nullptr);
	cin >> n;
	for(int i = 1; i < n; i ++)
		for(int j = i + 1; j <= n; j ++)
			cin >> G[i][j];
	ans = G[1][2];
	for(int i = 3, minv; i <= n; i ++) {
		minv = 0x3f3f3f3f;
		for(int j = 2; j < i; j ++) minv = min(minv, G[1][i] + G[j][i] - G[1][j] >> 1);
		ans += minv;
	}
	return cout << ans << '\n', 0;
}
</code></pre>
      `,

      quad: `
        <h1>四边形不等式</h1>

        <ol class="clean">
          <li>定义1：在定义域上 $\\forall a \\le b \\le c \\le d \\in Z$，有 $w_{a, d} + w_{b, c} \\le w_{a, c} + w_{b, d}$，则称二元函数 $w$ 满足四边形不等式。</li>
          <li>定义2：在定义域上 $\\forall a < b \\in Z$ 都有 $a < a+1 \\le b < b+1$，有 $w_{a,b+1} + w_{a+1,b} \\le w_{a,b} + w_{a+1,b+1}$，则称二元函数 $w$ 满足四边形不等式。</li>
        </ol>

        <p>定义1 和定义2 是等价的。</p>

        <ul class="clean">
          <li>定义1 通常是推单调性，定义2 通常来证明这个函数具有四边形不等式性质。</li>
        </ul>

        <h2>优化 dp</h2>
        <p>当 dp 的转移式满足：$\\displaystyle f_i = \\min_{0 \\leq j < i} \\{ f_j + v_{j,i} \\}$，且 $v_{j, i}$ 满足四边形不等式，则 $f_i$ 的最优决策具有单调性。</p>
        <p>$P_i$ 表示 $f_i$ 取到的最优解的 $j$，则 $P_i$ 单调不降。</p>

        <ul class="clean">
          <li>若 $p$ 对于 $i$ 比 $p$ 前面的所有决策都更优，则 $p$ 对于 $\\forall i' > i$ 都有 $p$ 比前面的所有决策更优。</li>
        </ul>

        <p>证明：</p>
        $$
        0 \\leq j < p < i < i'
        $$
        $$
        f_p + v_{p, i} \\leq f_j + v_{j, i}
        $$
        $$
        v_{j, i'} + v_{p, i} \\ge v_{j, i} + v_{p, i'}
        $$
        $$
        v_{p, i'} - v_{p, i} \\leq v_{j, i'} - v_{j, i}
        $$
        $$
        f_p + v_{p, i'} \\le f_j + v_{j, i'}
        $$
      `
    };

    // 生成目录
    function generateTOC(html) {
      const parser = new DOMParser();
      const doc = parser.parseFromString(html, 'text/html');
      const headings = doc.querySelectorAll('h1, h2, h3');
      let tocHTML = '<h3>文章目录</h3><ul>';
      for (let h of headings) {
        const level = parseInt(h.tagName[1]);
        const text = h.textContent;
        const id = text.replace(/\\s+/g, '-').toLowerCase();
        h.id = id;
        tocHTML += `<li style="margin-left:${(level-1)*16}px"><a href="#${id}">${text}</a></li>`;
      }
      tocHTML += '</ul>';
      return tocHTML;
    }

    // 加载文章
    async function loadPost(key) {
      const reader = document.getElementById('reader');
      const contentEl = document.getElementById('reader-content');
      const tocEl = document.getElementById('toc');

      reader.style.display = 'block';
      window.scrollTo(0, 0);
      contentEl.innerHTML = `
        <div class="skeleton skeleton-title"></div>
        <div class="skeleton skeleton-para"></div>
        <div class="skeleton skeleton-para" style="width:80%"></div>
      `;
      tocEl.innerHTML = '';

      setTimeout(() => {
        const html = posts[key];
        contentEl.innerHTML = html;
        tocEl.innerHTML = generateTOC(html);

        // 高亮代码
        contentEl.querySelectorAll('pre code').forEach(block => {
          const lang = block.className.replace('language-', '') || 'text';
          const displayName = { cpp: 'C++', python: 'Python', java: 'Java' }[lang] || lang.toUpperCase();
          const langTag = document.createElement('div');
          langTag.className = 'lang-tag';
          langTag.textContent = displayName;
          block.parentNode.style.position = 'relative';
          block.parentNode.insertBefore(langTag, block);
          hljs.highlightElement(block);
        });

        MathJax.typeset([contentEl]);
      }, 100);
    }

    function closeReader() {
      document.getElementById('reader').style.display = 'none';
    }

    function toggleTheme() {
      const root = document.documentElement;
      const isDark = root.getAttribute('data-theme') === 'dark';
      if (isDark) {
        setLight();
      } else {
        setDark();
      }
      localStorage.theme = isDark ? 'light' : 'dark';
    }

    function setDark() {
      document.documentElement.setAttribute('data-theme', 'dark');
      document.querySelector('.theme-toggle i').className = 'fas fa-sun';
      document.getElementById('hljs-theme-link').href = 'https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css';
    }

    function setLight() {
      document.documentElement.removeAttribute('data-theme');
      document.querySelector('.theme-toggle i').className = 'fas fa-moon';
      document.getElementById('hljs-theme-link').href = 'https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css';
    }

    // 主题初始化
    document.addEventListener('DOMContentLoaded', () => {
      if (localStorage.theme === 'dark' || (!localStorage.theme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        setDark();
      } else {
        setLight();
      }

      window.addEventListener('scroll', () => {
        const total = document.body.scrollHeight - window.innerHeight;
        const progress = total > 0 ? (window.scrollY / total) * 100 : 0;
        document.getElementById('reading-progress').style.width = `${Math.min(progress, 100)}%`;
      });

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(e => e.isIntersecting && e.target.classList.add('visible'));
      }, { threshold: 0.1 });
      document.querySelectorAll('.post').forEach(el => observer.observe(el));
    });
  </script>
</body>
</html>
